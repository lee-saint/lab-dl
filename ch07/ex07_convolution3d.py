import numpy as np
from scipy.signal import correlate


def convolution3d(x, w):
    xc, xh, xw = x.shape
    wc, wh, ww = w.shape
    conv = [[[np.sum(x[k:k+wc, j:j+wh, i:i+ww] * w) for i in range(xw - ww + 1)] for j in range(xh - wh + 1)] for k in range(xc - wc + 1)]
    return np.array(conv)


if __name__ == '__main__':
    np.random.seed(114)

    # (3, 4, 4) shape의 3차원 ndarray
    x = np.random.randint(10, size=(3, 4, 4))
    print('x =', x)
    # (3, 3, 3) shape의 3차원 ndarray
    w = np.random.randint(5, size=(3, 3, 3))
    print('w =', w)

    conv1 = correlate(x, w, mode='valid')
    print('conv1 =', conv1)

    # 위와 동일한 결과를 작성
    conv2 = convolution3d(x, w)
    print('conv2 =', conv2)

    x = np.random.randint(10, size=(3, 28, 28))
    w = np.random.rand(3, 16, 16)
    conv1 = correlate(x, w, mode='valid')
    conv2 = convolution3d(x, w)
    print(conv1.shape, conv2.shape)
    print(conv1)
    print(conv2







































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































          )
